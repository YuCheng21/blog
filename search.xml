<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hexo 基本配置</title>
      <link href="/post/hexo-configuration/"/>
      <url>/post/hexo-configuration/</url>
      
        <content type="html"><![CDATA[<h2 id="自訂文章網址"><a href="#自訂文章網址" class="headerlink" title="自訂文章網址"></a>自訂文章網址</h2><ol><li>在 <code>permalink</code> 中使用一個新增的變數 <code>urlname</code>。</li><li>在 <code>permalink_defaults</code> 中設定 <code>urlname</code> 的預設值為 <code>index</code>。</li></ol><p>之後要自訂文章網址時，只需要在 Markdown 文件中的 Front-matter 內設定 urlname 就可以客製化文章網址了。</p><ul><li><p>/_config.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">permalink:</span> <span class="string">post/:urlname/</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line">  <span class="attr">urlname:</span> <span class="string">index</span></span><br></pre></td></tr></table></figure></li></ul><p>未來在要發布的文章 Front-matter 上增加剛剛設定的 <code>urlname</code> 並設定自訂網址即可自訂文章網址。</p><ul><li><p>example_post.md</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">layout: post</span><br><span class="line">urlname: 文章網址</span><br><span class="line">title: 文章標題</span><br><span class="line">---</span><br></pre></td></tr></table></figure></li></ul><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="custom-URL-results.png" alt="自訂網址效果"></p><h2 id="自訂網站網址"><a href="#自訂網站網址" class="headerlink" title="自訂網站網址"></a>自訂網站網址</h2><p>以設定 <code>example.com</code> 網域為例：</p><h3 id="設定-Hexo-配置檔"><a href="#設定-Hexo-配置檔" class="headerlink" title="設定 Hexo 配置檔"></a>設定 Hexo 配置檔</h3><ul><li><p>/_config.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">url:</span> <span class="string">https://example.com</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><p>如果網站存放在子目錄中，例如 <code>http://example.com/blog</code>，請將 url 設為 <code>http://example.com/blog</code> 並把 <code>root</code> 設為 <code>/blog/</code>。</p></blockquote><h3 id="設定網址-DNS"><a href="#設定網址-DNS" class="headerlink" title="設定網址 DNS"></a>設定網址 DNS</h3><p>前往網址供應商的設定頁面設定 DNS</p><ul><li>A @ Github Pages<ul><li>A @ 185.199.108.153</li><li>A @ 185.199.109.153</li><li>A @ 185.199.110.153</li><li>A @ 185.199.111.153</li></ul></li><li>CNAME @ Github Repositories<ul><li>CNAME www example.com</li></ul></li></ul><p>以上有兩種類型設定分別是 <code>A 記錄</code> 和 <code>CNAME 記錄</code>，兩者重點都是在設定<code>名稱</code>和<code>內容</code>，不同的點在於：</p><ul><li>A 記錄是以<code>名稱</code>指向 <code>IP 地址（內容）</code>。</li><li>CNAME 記錄是以<code>名稱</code>指向<code>伺服器名稱（內容）</code></li></ul><p>這裡指的<strong>名稱</strong>其實也是指伺服器名稱，但在設定上只需要設定子網域就可以，例如像名稱 <code>www</code> 對應的就是 <code>www.example.com</code>，而<code>blog</code> 對應的就是 <code>blog.example.com</code>。www 和 blog 這部分也叫做子網域，每個子網域都是獨立分開的，如果不打算使用子網域，要直接使用主網域則設定 <code>@</code> 對應在 <code>example.com</code> 上。</p><p>了解名稱的意義後接著就要決定這個網域要指向哪裡，分別有兩種方法為 <code>A 記錄</code>與 <code>CNAME 記錄</code>。A 記錄指向的是 IP 地址，例如 xxx.xxx.xxx.xxx。CNAME 記錄指向的是伺服器名稱，例如 example.com。在設定 DNS 的時候要選擇 A 還是 CNAME 可以看自己的狀況決定。</p><p>上述例子是用 A 記錄以 <code>example.com</code> 指向 185.199.108.153，也就是 Github Pages 的地址，再用 CNAME 記錄以 <code>www.example.com</code> 指向 example.com。這樣一來，不管是 <code>example.com</code> 還是 <code>www.example.com</code> 最後都可以訪問到 Github Pages 的地址。</p><h3 id="設定-Github-Repositories"><a href="#設定-Github-Repositories" class="headerlink" title="設定 Github Repositories"></a>設定 Github Repositories</h3><ul><li>Github Repositories/Setting/Option/GitHub Pages<ul><li>Source<ol><li>Branch: <code>master</code><br>設定自己要發佈哪個分支，這裡選擇 master。</li><li>Folder: <code>/root</code><br>設定要發佈的資料夾位置，如果放在根目錄就選擇 root。</li><li>Save</li></ol></li><li>Custom domain<ul><li>example.com<br>這裡設定完 Custom domain 後會產生一個 commit，在根目錄建立一個 <strong>CNAME</strong> 檔案，裡面存放你的自訂網域，Custom domain 會以 CNAME 檔案內的網域為準，因此你也可以自己建立 CNAME 來設定 Custom domain，或直接複製 Github Pages 產生的 CNAME 放到 <code>/source/</code> 目錄下，這樣以後每次發佈網站之後 CNAME 也才會在網站的根目錄上。</li></ul></li></ul></li></ul><h3 id="設定-CNAME"><a href="#設定-CNAME" class="headerlink" title="設定 CNAME"></a>設定 CNAME</h3><ul><li><p>/source/CNAME</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">example.com</span><br></pre></td></tr></table></figure></li></ul><p>至於為什麼要創建 CNAME 呢？前面設定網域導向到 Github Pages 的地址後還有一個問題是，Github Pages 的用戶數很多，當別人從你的網域指向他們的地址後，他們不知道來自這個網域的訪問要導向哪個用戶的儲存庫，因此在儲存庫的跟資料夾底下放一個檔案叫 <code>CNAME</code>，裡面儲存你的網域名稱，Github Pages 會去從這個檔案中知道這個儲存庫是要接收來自 <code>CNAME</code> 儲存的網域名稱，把訪問導向你的儲存庫。</p><h2 id="設定新增文章格式"><a href="#設定新增文章格式" class="headerlink" title="設定新增文章格式"></a>設定新增文章格式</h2><p>通常使用 <code>hexo new post &lt;title&gt;</code> 來新增文章時，是直接使用 &lt;title&gt; 來當作資料夾和檔案的名稱，當檔案多的時候可能會有些不好管理，這裡設定 <code>new_post_name</code> 來調整資料夾和檔案的名稱。</p><ul><li><p>/_config.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">new_post_name:</span> <span class="string">:year:month:day</span> <span class="bullet">-</span> <span class="string">:title.md</span></span><br></pre></td></tr></table></figure></li></ul><p>這樣檔案開頭都會統一以日期當作編號，可以了解文章的發布日期當作參考。</p><blockquote><p>同時也可以在 <code>/scaffolds</code> 內的 post 或 draft 設定新增的文章 Front-matter 預設的格式。</p></blockquote><h2 id="設定不渲染的檔案"><a href="#設定不渲染的檔案" class="headerlink" title="設定不渲染的檔案"></a>設定不渲染的檔案</h2><p>在發布網站時 Hexo 會將 <code>/source</code> 下的 Markdown 檔案經過 <code>/themes</code> 內選擇的主題進行渲染，如果有不想要經過主題渲染的檔案的話，可以在配置檔案中設定例外檔案。</p><ul><li><p>/_config.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">skip_render:</span> <span class="string">README.md</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><p>忽略 README.md 讓上傳到 Github 上時，使用原始的 README.md 檔案，顯示儲存庫的說明文件。</p></blockquote><h2 id="使用各別文章資料夾"><a href="#使用各別文章資料夾" class="headerlink" title="使用各別文章資料夾"></a>使用各別文章資料夾</h2><p>文章內要使用檔案時可以將檔案放在 <code>/source/images</code> 中使用，當文章多的時候同樣可能會不好管理，這裡通過設定 <code>post_asset_folder</code> 來開啟各別文章資料夾。</p><ul><li><p>/_config.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></li></ul><p>這樣每當使用 <code>hexo new post &lt;title&gt;</code> 建立新文章時，同時會在 <code>_post</code> 內建立一個和 &lt;title&gt; 同名的資料夾，將文章需要的檔案放在資料夾內，就可以直接使用檔案。</p><h2 id="首頁每頁顯示的文章數"><a href="#首頁每頁顯示的文章數" class="headerlink" title="首頁每頁顯示的文章數"></a>首頁每頁顯示的文章數</h2><ul><li><p>/_config.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首頁設定</span></span><br><span class="line"><span class="comment"># path: 網站首頁根路徑。（預設 = &#x27;&#x27;）</span></span><br><span class="line"><span class="comment"># per_page: 每頁顯示的文章數量（0 = 禁用分頁）</span></span><br><span class="line"><span class="comment"># order_by: 文章排序（預設按日期遞減排序）</span></span><br><span class="line"><span class="attr">index_generator:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">6</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="sitemap-xml-搜尋引擎爬蟲"><a href="#sitemap-xml-搜尋引擎爬蟲" class="headerlink" title="sitemap.xml 搜尋引擎爬蟲"></a>sitemap.xml 搜尋引擎爬蟲</h2><p>設定 Google 搜尋引擎收錄資料</p><p>進入 <a href="https://search.google.com/search-console/about?hl=zh-TW">Google Search Console</a> 驗證自己的網域，驗證網域的方式有很多種，選擇一種適合自己的方法即可。</p><p>接下來要使用 Google Search Concole 的 Sitemap 功能，將網站的 Sitemap 提交給 Google，提供給搜尋引擎爬蟲使用。這裡先安裝可以自動產生 <code>sitemap.xml</code> 的套件 <a href="https://github.com/hexojs/hexo-generator-sitemap">hexo-generator-sitemap</a>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-sitemap --save</span><br></pre></td></tr></table></figure><p>接著在 <code>_config.yml</code> 增加 Sitemap 設定</p><ul><li><p>/_config.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sitemap</span></span><br><span class="line"><span class="comment"># path：sitemap 路徑</span></span><br><span class="line"><span class="comment"># tags：是否要包含標籤（不包含標籤頁）</span></span><br><span class="line"><span class="comment"># categories：是否要包含分類（不包含分類頁）</span></span><br><span class="line"><span class="attr">sitemap:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">sitemap.xml</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure></li></ul><p>之後每當 Hexo 產生網站的靜態資源時，也會自動產生一個 <code>sitemap.xml</code> 在 Public 目錄下，也就是發佈到網站上時會在根目錄上 <code>example.com/sitemap.xml</code>，之後再到 Google Search Console 上的 Sitemap 功能頁面新增 sitemap.xml。</p><p>這樣以後 Google 的爬蟲就會定期去看 sitemap.xml 檔案是否有更新，若有更新他就會去爬你的網站並加入到搜尋引擎中了。</p><blockquote><p>如果有特定的頁面不希望被加入 sitemap.xml 中，可以在頁面的 markdown 中 Front-matter 設定 <code>sitemap: false</code>。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">sitemap: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure></blockquote><h2 id="robots-txt-管理爬蟲"><a href="#robots-txt-管理爬蟲" class="headerlink" title="robots.txt 管理爬蟲"></a>robots.txt 管理爬蟲</h2><p><code>robots.txt</code> 與設定 meta robots 不同在於，meta 內設定的是<strong>建立索引</strong> (index) 和<strong>連結權重</strong> (follow)，而 robots.txt 設定的是告訴爬蟲機器人哪些是可以爬的，哪些是不能爬的。</p><p><strong>建立索引</strong>只在當爬蟲機器人要把你的網址索引在搜尋引擎上時會作用。<strong>連結權重</strong>只負責決定你的頁面是否擔保連出去的連結。然而不管有沒有設定上面兩個，爬蟲機器人都有可能會進到你的網站爬取資料，例如從別人的網站連結近來，如果你有某個頁面不希望被爬到，除了在 sitemap.xml 內不要放入這個頁面外，還可以在網頁根目錄中配置一個檔案 <code>robots.txt</code>，用來控制爬蟲機器人在網站中某些頁面能不能存取。</p><p>這裡我沒有特別需要阻擋特定頁面，因此 <code>robots.txt</code> 設定全部允許。</p><ul><li><p>User-agent : 爬蟲程式的名字</p><p>必要項目，可以在每項規則中指定一或多個 user-agent。</p></li><li><p>Disallow : 不應爬取的網頁網址</p><p>每項規則至少要有一個 Disallow 或 Allow 的指令，Disallow 用以表示禁止爬蟲程式的項目。若為網頁，應撰寫完整的相對路徑；若為目錄，則必須以 / 作為結尾。</p></li><li><p>Allow : 允許爬取的網頁網址</p><p>每項規則至少要有一個 Disallow 或 Allow 的指令，Allow 用以表示允許爬蟲程式的項目，可覆蓋以 Disallow 禁止的項目。若為網頁，應撰寫完整的相對路徑；若為目錄，則必須以 / 作為結尾。</p></li><li><p>Crawl-delay  : 抓取網頁前延遲</p></li></ul><p>非必要項目，用以告訴在開始抓取網頁前延遲多久，單位為毫秒。</p><ul><li><p>Sitemap : 網站地圖的路徑</p><p>非必要，可以透過這個指令指出 XML 網站地圖的位置，也可以同時提供多個網站地圖分行列出，此項目應使用絕對路徑。</p></li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow:</span><br><span class="line"></span><br><span class="line">Sitemap: https://example.com/sitemap</span><br></pre></td></tr></table></figure><h2 id="Google-Analytics-分析流量"><a href="#Google-Analytics-分析流量" class="headerlink" title="Google Analytics 分析流量"></a>Google Analytics 分析流量</h2><p>在搜尋引擎收錄完我們的文章後，我們可以利用 <a href="https://analytics.google.com/">Google Analytics</a>（簡稱 GA） 分析我們的網站流量，從分析結果了解我們網站的效果。首先進入 GA 建立帳戶，建立完帳戶後再新增資源，之後再新增串流，也就是我們的網站，完成後依照說明讓網頁嵌入指定代碼即可。</p><blockquote><p>測試使用者方法可以開無痕視窗瀏覽，讓瀏覽器重新請求一次。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 子網域 </tag>
            
            <tag> 網站地圖 </tag>
            
            <tag> 搜尋引擎收錄 </tag>
            
            <tag> Google Analytics </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo ButterFly 主題配置</title>
      <link href="/post/hexo-butterfly-theme-configuration/"/>
      <url>/post/hexo-butterfly-theme-configuration/</url>
      
        <content type="html"><![CDATA[<h2 id="基本設定"><a href="#基本設定" class="headerlink" title="基本設定"></a>基本設定</h2><p>將主題內的配置檔 <code>/themes/butterfly/_config.yml</code> 複製到根目錄 <code>/</code>，並重新命名成 <code>_config.butterfly.yml</code>，這樣根目錄的配置檔案設定會覆蓋主題內的配置檔案設定，在升級主題時比較好升級。</p><ul><li><a href="https://butterfly.js.org/posts/21cfbf15/">Butterfly 安裝文檔 (一) 快速開始</a></li><li><a href="https://butterfly.js.org/posts/dc584b87/">Butterfly 安裝文檔 (二) 主題頁面</a></li><li><a href="https://butterfly.js.org/posts/4aa8abbe/">Butterfly 安裝文檔 (三) 主題配置 - 1</a></li><li><a href="https://butterfly.js.org/posts/ceeb73f/">Butterfly 安裝文檔 (四) 主題配置 - 2</a></li><li><a href="https://butterfly.js.org/posts/98d20436/">Butterfly 安裝文檔 (五) 主題問答</a></li><li><a href="https://butterfly.js.org/posts/4073eda/">Butterfly 安裝文檔 (六) 進階教程</a></li><li><a href="https://butterfly.js.org/posts/198a4240/">Butterfly 安裝文檔 (七) 更新日誌</a></li></ul><h2 id="滾動條外觀"><a href="#滾動條外觀" class="headerlink" title="滾動條外觀"></a>滾動條外觀</h2><ul><li><p>/source/css/_global/index.styl</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 滾動條</span></span><br><span class="line">*::-webkit-scrollbar</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">12px</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">12px</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 滾動條背景</span></span><br><span class="line">*::-webkit-scrollbar-track</span><br><span class="line">  <span class="attribute">background-color</span>: transparent</span><br><span class="line"></span><br><span class="line"><span class="comment">// 滾動條背景: 懸停</span></span><br><span class="line">::-webkit-scrollbar-track:hover</span><br><span class="line"></span><br><span class="line"><span class="comment">// 滾動條方塊</span></span><br><span class="line">*::-webkit-scrollbar-thumb</span><br><span class="line">  <span class="attribute">background</span>: var(--btn-bg)</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 滾動條方塊: 懸停</span></span><br><span class="line">*::-webkit-scrollbar-thumb:hover</span><br><span class="line">  <span class="attribute">background-color</span>: var(--btn-hover-color)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 滾動條方塊: 點擊</span></span><br><span class="line">*::-webkit-scrollbar-thumb:active</span><br></pre></td></tr></table></figure></li></ul><h2 id="深色模式顏色"><a href="#深色模式顏色" class="headerlink" title="深色模式顏色"></a>深色模式顏色</h2><ul><li><p>/source/css/_mode/darkmode.styl</p><ul><li><p>顏色取代</p><ol><li>#121212 -&gt; #2F3437</li><li>#2c2c2c -&gt; #60666C</li></ol></li><li><p>個別調整</p><figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span><br><span class="line">  <span class="comment">// 調整 1</span></span><br><span class="line">  --card-bg: lighten(<span class="number">#2F3437</span>, <span class="number">5</span>)</span><br><span class="line">  <span class="comment">// 調整 2</span></span><br><span class="line">  --btn-bg: lighten(<span class="number">#2F3437</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#page-header</span>:before</span><br><span class="line">    <span class="comment">// 調整 3</span></span><br><span class="line">    <span class="attribute">background-color</span>: darken(<span class="number">#2F3437</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">  #article-container</span><br><span class="line">    <span class="selector-tag">figure</span>.highlight</span><br><span class="line">      <span class="attribute">box-shadow</span>: none</span><br><span class="line">      .highlight-tools</span><br><span class="line">        <span class="comment">// 調整 4</span></span><br><span class="line">        <span class="attribute">background</span>: lighten(<span class="number">#2F3437</span>, <span class="number">0</span>) !important</span><br></pre></td></tr></table></figure></li></ul></li></ul><h2 id="閱讀模式顏色"><a href="#閱讀模式顏色" class="headerlink" title="閱讀模式顏色"></a>閱讀模式顏色</h2><ul><li><p>/source/css/_mode/readmode.styl</p><ul><li><p>個別調整</p><figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> hexo-config(<span class="string">&#x27;readmode&#x27;</span>)</span><br><span class="line">  [data-theme=<span class="string">&#x27;dark&#x27;</span>]</span><br><span class="line">      .read-mode</span><br><span class="line">        --readmode-light-<span class="attribute">color</span>: darken(<span class="number">#2F3437</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure></li></ul></li></ul><h2 id="文章頁隱藏卡片"><a href="#文章頁隱藏卡片" class="headerlink" title="文章頁隱藏卡片"></a>文章頁隱藏卡片</h2><p>讓卡片經過判斷後產生</p><ul><li><p>/themes/butterfly/layout/includes/widget/index.pug</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">  &lt;!-- 刪除 --&gt;</span><br><span class="line">  #aside_content.aside_content</span><br><span class="line">-   if theme.aside.card_author.enable</span><br><span class="line">-     !&#x3D;partial(&#39;includes&#x2F;widget&#x2F;card_author&#39;, &#123;&#125;, &#123;cache:theme.fragment_cache&#125;)</span><br><span class="line">-   if theme.aside.card_announcement.enable</span><br><span class="line">-     !&#x3D;partial(&#39;includes&#x2F;widget&#x2F;card_announcement&#39;, &#123;&#125;, &#123;cache:theme.fragment_cache&#125;)</span><br><span class="line">    .sticky_layout</span><br><span class="line">  &lt;!-- 新增 --&gt;</span><br><span class="line">    else</span><br><span class="line">+    if theme.aside.card_author.enable</span><br><span class="line">+      !&#x3D;partial(&#39;includes&#x2F;widget&#x2F;card_author&#39;, &#123;&#125;, &#123;cache:theme.fragment_cache&#125;)</span><br><span class="line">+    if theme.aside.card_announcement.enable</span><br><span class="line">+      !&#x3D;partial(&#39;includes&#x2F;widget&#x2F;card_announcement&#39;, &#123;&#125;, &#123;cache:theme.fragment_cache&#125;)</span><br><span class="line">      if theme.aside.card_recent_post.enable</span><br><span class="line">        !&#x3D;partial(&#39;includes&#x2F;widget&#x2F;card_recent_post&#39;, &#123;&#125;, &#123;cache:theme.fragment_cache&#125;)</span><br></pre></td></tr></table></figure></li></ul><h2 id="Head-加入-robots"><a href="#Head-加入-robots" class="headerlink" title="Head 加入 robots"></a>Head 加入 robots</h2><p>當搜尋引擎爬蟲機器人進入我們網站後，我們可以在 head 中的 meta 設定 robots，告訴機器人這個頁面我是否想要在搜尋引擎上建立索引，還有我是否要傳遞權重給我網站頁面中的連結，例如：<code>meta(name=&quot;robots&quot; content=&quot;index,follow&quot;)</code>。</p><blockquote><p>需要注意的是，如果頁面設定是 <code>noindex</code>，也就是不希望機器人將這個頁面建立索引，在網站中的 sitemap.xml 中也不應該包含該頁面，因為這時爬蟲機器人被你叫來建立索引，結果你的頁面告訴他禁止建立索引，在後台報表會出現報錯，雖然對我們來說實際效果差不多，但 GoogleBot 不希望我們這樣做。</p></blockquote><ul><li><p>/themes/butterfly/layout/includes/head.pug</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include .&#x2F;head&#x2F;robots.pug</span><br></pre></td></tr></table></figure></li><li><p>/themes/butterfly/layout/includes/head/robots.pug</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">if page.robots</span><br><span class="line">    meta(name&#x3D;&quot;robots&quot; content&#x3D;page.robots)</span><br><span class="line">else if is_home()</span><br><span class="line">    if page.prev &#x3D;&#x3D; 0</span><br><span class="line">        meta(name&#x3D;&quot;robots&quot; content&#x3D;&quot;index,follow&quot;)</span><br><span class="line">    else</span><br><span class="line">        meta(name&#x3D;&quot;robots&quot; content&#x3D;&quot;noindex,follow&quot;)</span><br><span class="line">else if is_archive()</span><br><span class="line">    meta(name&#x3D;&quot;robots&quot; content&#x3D;&quot;noindex,follow&quot;)</span><br><span class="line">else if is_category()</span><br><span class="line">    meta(name&#x3D;&quot;robots&quot; content&#x3D;&quot;noindex,follow&quot;)</span><br><span class="line">else if is_tag()</span><br><span class="line">    meta(name&#x3D;&quot;robots&quot; content&#x3D;&quot;noindex,follow&quot;)</span><br><span class="line">else if is_post()</span><br><span class="line">    meta(name&#x3D;&quot;robots&quot; content&#x3D;&quot;index,nofollow&quot;)</span><br></pre></td></tr></table></figure></li></ul><h2 id="Gitalk-留言板-ID"><a href="#Gitalk-留言板-ID" class="headerlink" title="Gitalk 留言板 ID"></a>Gitalk 留言板 ID</h2><p>主題預設會使用網址的 MD5 碼當 Issues 的 ID，此處改回使用網址當 ID。</p><ul><li><p>/themes/butterfly/layout/includes/third-party/comments/gitalk.pug</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  &lt;!-- 刪除 --&gt;</span><br><span class="line">-         id: &#39;!&#123;md5(page.path)&#125;&#39;,</span><br><span class="line">  &lt;!-- 新增 --&gt;</span><br><span class="line">+         id: &#39;!&#123;page.path&#125;&#39;,</span><br></pre></td></tr></table></figure></li></ul><h2 id="調整文字大小"><a href="#調整文字大小" class="headerlink" title="調整文字大小"></a>調整文字大小</h2><p>先調整主題配置檔案，字體放大後，有些佈局排版也會變化，跟著一起調整。</p><ul><li><p>/_config.butterfly.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">font:</span></span><br><span class="line">  <span class="attr">global-font-size:</span> <span class="string">18px</span></span><br><span class="line">  <span class="attr">code-font-size:</span> <span class="string">18px</span></span><br><span class="line">  <span class="attr">font-family:</span> <span class="string">-apple-system,</span> <span class="string">BlinkMacSystemFont,</span> <span class="string">&quot;Segoe UI&quot;</span><span class="string">,</span> <span class="string">&quot;Helvetica Neue&quot;</span><span class="string">,</span> <span class="string">Lato,</span> <span class="string">Roboto,</span> <span class="string">&quot;PingFang SC&quot;</span><span class="string">,</span> <span class="string">&quot;Microsoft JhengHei&quot;</span><span class="string">,</span> <span class="string">&quot;Microsoft YaHei&quot;</span><span class="string">,</span> <span class="string">sans-serif</span></span><br><span class="line">  <span class="attr">code-font-family:</span> <span class="string">consolas,</span> <span class="string">Menlo,</span> <span class="string">&quot;PingFang SC&quot;</span><span class="string">,</span> <span class="string">&quot;Microsoft JhengHei&quot;</span><span class="string">,</span> <span class="string">&quot;Microsoft YaHei&quot;</span><span class="string">,</span> <span class="string">sans-serif</span></span><br></pre></td></tr></table></figure></li><li><p>/themes/butterfly/source/css/_page/homepage.styl</p><figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 調整首頁卡片高度</span></span><br><span class="line">#recent-posts</span><br><span class="line">  &amp; &gt; .recent-post-item</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">15.5em</span></span><br></pre></td></tr></table></figure></li><li><p>/themes/butterfly/source/css/_layout/aside.styl</p><figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 調整文章目錄字型大小</span></span><br><span class="line">#aside_content</span><br><span class="line">  #card-toc</span><br><span class="line">    .toc-<span class="attribute">content</span></span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">14px</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>/themes/butterfly/source/css/_page/common.styl</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 調整文章內容邊界</span></span><br><span class="line">.layout</span><br><span class="line">  &amp; &gt; <span class="selector-tag">div</span>:first-child:not(.recent-posts)</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">25px</span> <span class="number">40px</span></span><br><span class="line"></span><br><span class="line">    +maxWidth768()</span><br><span class="line">      padding: 0.9rem .7rem !important</span><br></pre></td></tr></table></figure></li><li><p>/themes/butterfly/source/css/_layout/post.styl</p><figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 調整段落間距</span></span><br><span class="line">#article-container</span><br><span class="line">  p</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">1.6rem</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">beautify</span><span class="params">()</span></span></span><br><span class="line">  <span class="selector-tag">ol</span>,</span><br><span class="line">  ul</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">2rem</span></span><br><span class="line"></span><br><span class="line">  ul</span><br><span class="line">    &gt; <span class="selector-tag">li</span>:not(.tab)</span><br><span class="line">      padding: 0 .2em 0 1.4em</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">no-beautify</span><span class="params">()</span></span></span><br><span class="line">  <span class="selector-tag">ol</span>,</span><br><span class="line">  ul</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">2rem</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 主題 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>KD-Tree 演算法筆記</title>
      <link href="/post/kd-tree/"/>
      <url>/post/kd-tree/</url>
      
        <content type="html"><![CDATA[<h2 id="簡介"><a href="#簡介" class="headerlink" title="簡介"></a>簡介</h2><p>KD 樹又稱 K 維樹 (K-dimensional tree)，是一種可以對 K 維資料進行劃分的資料結構，可以看成二元搜尋樹的一種延伸，不斷的對空間中的維度做劃分，利用搜尋樹剪枝的特性縮短時間複雜度，主要應用在多維空間搜尋，例如最近鄰居搜索。</p><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="build-kd-tree.png" alt="KD 樹概念"></p><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>以前在學資料結構的時候，學過使用二元搜尋樹將<strong>資料</strong>用大小區分來建樹，每個點代表著一筆<strong>資料</strong>，這個方法在資料只有一個維度的時候行的通，但當資料超過一個維度的時候就遇到困難，該怎麼對二維以上的陣列進行劃分。</p><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="binary-search-tree.png" alt="二元搜尋樹"></p><h2 id="想法"><a href="#想法" class="headerlink" title="想法"></a>想法</h2><p>對於多維陣列，我們多了一個以上的維度，因此在劃分時沒有一個劃分依據，此時我們可以將所有資料統一<strong>使用其中一個維度進行劃分</strong>，這個動作在二維資料內相當於將空間劃分為兩個部分，得到兩個新的<strong>子空間</strong>，如果我們繼續對這兩個子空間進行上述劃分，又會得到新的子空間，重複以上過程直到每個子空間都不能再劃分為止。</p><blockquote><p>相當於不斷的用超平面將 K 維空間切分，每個節點對應一個 K 維超矩形區域。</p></blockquote><p>以上就是建立 KD 樹的過程，上述過程中涉及到兩個重要的問題：</p><ol><li>每次選擇其中一個維度進行劃分時，應該選擇哪個維度進行劃分？</li><li>在某個維度上的進行劃分時，應該選擇哪個節點進行劃分？</li></ol><h2 id="劃分方法"><a href="#劃分方法" class="headerlink" title="劃分方法"></a>劃分方法</h2><h3 id="術語"><a href="#術語" class="headerlink" title="術語"></a>術語</h3><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="pivot-process-analysis.png" alt="空間劃分過程拆解"></p><ul><li>cell：KD 樹數據結構為把空間遞歸地劃分兩個不相交的超矩形（類似於超平面、超立方體的概念），每個超矩形所佔的空間即為一個 cell。</li><li>bounding rectangle：包含數據集中所有點的最小超矩形。其範圍小於等於該節點對應 cell 的大小。</li><li>aspect ratio：cells 中最長邊與最短邊的長度比，比值越大，數目 cell 越細長，反之，越肥胖。</li><li>spread：數據集在某維度上最大值減最小值。即該維度上 bounding rectangle 對應邊的長度。</li></ul><h3 id="準則"><a href="#準則" class="headerlink" title="準則"></a>準則</h3><p>以下列出 ANN 中提供的幾種劃分規則：</p><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="standard-and-midpoint-and-sliding-midpoint-splitting-methods.png" alt="標準、中點、滑動中點劃分規則"></p><ul><li>standard kd-tree splitting rule（標準 KD 樹分割規則）：<ul><li>基本思想：使創建出來的樹盡可能的保持平衡，樹越平衡代表著分割得越平均，搜尋的時間也就越少。</li><li>維度選擇有兩種方法（二擇一）：<ol><li>選擇 spread 最大的維度，即 bounding rectangle 中最長邊對應的維度。即數據集在該維度上，最大值減最小值的結果為所有維度中最大的維度。</li><li>選擇變異數最大的維度，即數據在該維度上，數據分散的比較開的維度，</li></ol></li><li>劃分點選擇：選擇數據集在該維度上的中位數做為劃分點，讓左子樹和右子樹的元素數量盡量保持一致，且其中一個子節點的元素值都小於另一個子節點。</li><li>優點：劃分到左右子樹中數據數量相同（或相差 1），為平衡二元樹。</li><li>缺點：<ol><li>維度選擇方法一，可能出現細長的cell，容易增加回溯時遞迴搜尋的範圍。</li><li>維度選擇方法二，計算最大變異數的時間複雜度要高於計算最大 spread 的時間複雜度。</li></ol></li></ul></li></ul><hr><ul><li>midpoint splitting rule（中點分割規則）：<ul><li>基本思想：讓分割出的 cells 盡可能的減少產生細長的 cell，使劃分出的兩個 cells 都是肥胖的。</li><li>維度選擇：cell 中最長邊對應的維度。</li><li>劃分點選擇：cell 中最長邊對應的中心。</li><li>優點：找中心比找中值的時間複雜度更低。</li><li>缺點：導致數據集劃分不均勻，當數據大量聚集時，存在很多無用的空間劃分（即劃分時，所有數據都在一個區域，另一個區域沒有數據）。</li></ul></li></ul><hr><ul><li>sliding midpoint rule（滑動中點規則）：<ul><li>基本思想：midpoint splitting rule 的改進版，規則大致相同，其認為兩種劃分為好的劃分：<ol><li>平衡的劃分：使得劃分出的兩個子 cell 都是肥胖的（midpoint splitting rule中的思想）</li><li>使得較肥胖的 cell 中含有較少的數據點。（對無效劃分的處理）</li></ol></li><li>維度選擇：選擇超矩形中最長邊對應的維度。（同 midpoint splitting rule）</li><li>劃分點的選擇：在劃分時，當劃分結果沒有包含任何數據集，出現無效劃分時，通過滑動分割點來消除無效劃分，若該維度的中點值為 a：<ul><li>若所有數據在該維度上都大於 a，則以數據集中最小值來劃分空間，使左子樹區域中有 1 個點，右子樹有 n-1 個點。</li><li>若所有數據在該維度上都小於 a，則以數據集中最大值來劃分空間，使左子樹區域中有 n-1 個點，右子樹有 1 個點。</li></ul></li><li>優點：通過滑動劃分點，可以消除無效的劃分。其可能存在細長的 cell，但其始終伴隨著一個該維度上較寬胖的 cell。</li></ul></li></ul><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="sliding-midpoint-rule-example.png" alt="滑動中點規則範例"></p><hr><ul><li>fair-split rule（公平分割規則）：<ul><li>standard kd-tree splitting rule 與 midpoint splitting rule 的折衷方法</li><li>基本思想：設定一個合理的 aspect ratio 值為 a。在劃分空間時盡量滿足子 cell 的 aspect ratio 小於 a 且盡量使數據均勻的分佈在兩個子 cell 中。</li><li>給定一個 cell：<ul><li>根據 cell 各邊的長度，選出能夠使得劃分出兩個子 cell 能滿足 aspect ratio 小於 a 的所有維度。</li><li>在上述選出的維度中，選擇 bounding rectangle 中最長邊對應的維度。</li><li>在滿足 aspect ratio 小於 a 的前提下，在該維度上選擇一個使得數據點盡可能分佈均勻的劃分點來對 cell 進行最終的劃分。（standard kd-tree splitting rule 的思想 - 取中位數）</li></ul></li><li>優點：相比於 midpoint splitting rule，對於無效的劃分，有更好的劃分結果。然而當數據高度聚集時，仍有可能出現與 midpoint splitting rule 相同的結果。</li></ul></li></ul><hr><ul><li>sliding fair-split rule（滑動公平分割規則）：結合 fair-split rule 與 sliding midpoint rule 的思想<ul><li>基本思想：上述 fair-split rule 劃分不能避免：由於必須滿足 aspect ratio 小於 a，使得極端情況下，使數據點盡可能的均勻分佈的劃分仍然為一個無效劃分的情況。此時可以通過滑動劃分點至該維度上最大（或最小）的值處（即 sliding 的思想）來進行劃分（此時無需滿足 aspect ratio 小於 a 的條件），使得每個劃分都至少含有一個數據點。</li></ul></li></ul><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="splitting-rules-on-common-data-set-example.png" alt="常見數據集分別在標準、中點、滑動中點規則的表現"></p><p>無論哪種劃分規則，都不會影響 KD 樹搜索結果的正確性，只會影響其樹的形狀和深度，從而影響搜索性能。總而言之，希望得到的 KD 樹的結構盡量滿足兩個特點：</p><ol><li>盡可能的平衡</li><li>盡可能的讓 cell 肥胖（使搜索過程中與超矩形相交的個數盡量少，以減小到韃子葉的次數）</li></ol><h2 id="資料儲存方法"><a href="#資料儲存方法" class="headerlink" title="資料儲存方法"></a>資料儲存方法</h2><h3 id="將數據儲存在所有節點"><a href="#將數據儲存在所有節點" class="headerlink" title="將數據儲存在所有節點"></a>將數據儲存在所有節點</h3><ul><li>葉節點、中間節點：<ul><li>維度</li><li>點</li><li>左子節點</li><li>右子節點</li></ul></li></ul><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="store-in-node.png" alt="數據儲存在所有節點範例"></p><h3 id="將數據僅儲存在葉節點"><a href="#將數據僅儲存在葉節點" class="headerlink" title="將數據僅儲存在葉節點"></a>將數據僅儲存在葉節點</h3><ul><li>中間節點：<ul><li>維度</li><li>劃分軸</li><li>左子節點</li><li>右子節點</li></ul></li><li>葉節點：<ul><li>點</li></ul></li></ul><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="stored-in-leaf-nodes.png" alt="將數據僅儲存在葉節點範例"></p><h2 id="建樹"><a href="#建樹" class="headerlink" title="建樹"></a>建樹</h2><p>這裡我們建立 KD 樹的方法使用：</p><ul><li>standard kd-tree splitting rule（標準 KD 樹分割規則）</li><li>選擇最大變異數做為維度選擇方法</li><li>將數據儲存在所有節點</li></ul><p>決定上述兩個方法後，我們 KD 樹的建立過程如下：</p><ol><li>在 K 維資料集合中選擇具有最大變異數的維度 K，然後在該維度上選擇中位數 m 做為分割點對該資料集合進行劃分，得到兩個子集合，同時建立一個樹節點用於儲存。</li><li>對兩個子集合重複 (1) 步驟的過程，直到所有子集合都不能在劃分為止。</li></ol><h3 id="範例"><a href="#範例" class="headerlink" title="範例"></a>範例</h3><p>假設有一個二維陣列：[[2, 3], [5, 4], [9, 6], [4, 7], [8, 1], [7, 2]]</p><p>KD 樹演算法就是要確定下圖中這些分割空間的分割線（多維空間即為分割平面，一般為超平面）。</p><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="kd-tree-build-step.png" alt="KD 樹建立步驟"></p><ol><li>分別計算 x, y 方向上資料的變異數，得出 x 方向上的變異數最大</li><li>根據 x 軸方向的值 (2, 4, 5, 7, 8, 9)，排序選出中位數為 5 和 7，這裡選擇 7 當作分割點，所以該節點中的資料為 (7, 2)。這樣該節點的分割超平面就是通過 (7, 2) 並垂直於 x 軸的直線 x = 7。</li><li>確定左子空間和右子空間。以 x = 7 為分割超平面將整個空間分為兩個部分，x &lt;= 7 的部分為左子空間，包含 3 個節點 (2, 3), (4, 7), (5, 4)，另一部分為右子空間，包含2個節點 (8, 1), (9, 6)。</li></ol><p>KD 樹的建立是一個遞迴的過程。繼續對左子空間和右子空間內的資料重複根節點的操作就可以得到下一級子節點 (5, 4) 和 (9, 6) (也就是左右子空間的根節點)，同時將空間和資料進一步細分。如此反覆值到空間中只包含一個資料點。</p><h2 id="尋找最近點"><a href="#尋找最近點" class="headerlink" title="尋找最近點"></a>尋找最近點</h2><p>KD Tree 建好之後，接下來就可以使用 KD Tree 對元素搜尋最近點，方法如下：</p><ul><li>查詢目標節點：Q</li><li>當前最佳節點：P</li></ul><ol><li>建立一個空的堆疊 S。</li><li>從根節點開始走訪，根據 Q 在分割維度中是否小於或大於當前節點，向左或向右移動，將每個走訪過的節點都存入（Push） S。</li><li>一旦不能再走訪，設定 P 為無限大，並開始循環以下：<ol><li>將 S 取出（Pop）為當前節點 C。從概念上來看，S 會不斷取出走訪過的節點，意義即為從葉節點返回父節點，稱為<strong>回溯</strong>。</li><li>計算 C 到 Q 的距離，如果 C 比 P 更接近 Q，那麼更新 P 為該節點。</li><li>檢查在 C 分割面的另一邊是否有比 P 距離更近的節點。從概念上來說，以 Q 為中心，以 P 為半徑劃一個超球面，看這個超球面是否穿過了分割平面。因為平面都是座標軸對應的，所以只需要簡單比較 <strong>Q</strong> 和<strong>當前節點分割面</strong>的距離是否比 P 距離更小。<ol><li>如果超球面穿越分割面，那麼分割面的另外一側<strong>可能</strong>還有最近點，所以需要對 KD 樹的另一邊的分支在執行一次走訪，將每個走訪過的節點都存入（Push） S。</li><li>如果超球面沒有穿過分割面，則分割面的另外一邊的整個分支會被剪掉，稱為<strong>剪枝</strong>，並繼續搜尋其它節點，即<strong>回溯</strong>。</li></ol></li></ol></li><li>當 S 為空，也就是算法最後回溯到根節點的時候，搜尋完成，返回結果。</li></ol><blockquote><ol><li>通常，算法使用距離平方來做比較，而不使用更耗時的平方根。可以通過維持當前最佳的平方距離來節省計算量。</li><li>計算距離步驟可以在檢查分割面後面，優點是在判斷完分割面沒有相交的節點後，可以直接判斷跳過計算該距離的步驟，因為只要沒有與分割面相交，距離就不會更近。這裡因為解釋順序方便將距離計算在前面，實際這樣會在某些情況額外計算一些無意義的距離。</li></ol></blockquote><h3 id="剪枝概念"><a href="#剪枝概念" class="headerlink" title="剪枝概念"></a>剪枝概念</h3><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="kd-tree-pruning-concept.png" alt="KD 樹的剪枝概念"></p><p>KD 演算法的核心技巧在於剪枝，在已經搜索到 B 時，發現其到 B 的距離，要比到 A 的右子樹的平面距離還更短，所以整個 A 的右子樹都被剪枝，一下子剪去了一半的點。</p><p>這個算法也可以通過簡單的修改做多種延伸。比如，可用於計算 K 個最近臨點，這個時候需要保存 K 個當前最佳而不是一個。分支能夠剪掉的條件是：K 個點都找到，並且分支中沒有比這 K 個最佳更近的點。</p><p>也可以轉換為近似算法加快運行。例如，近似最近點搜尋可以通過指定檢查節點的上限來達成，也可以基於時鐘(在硬體實現更合適)終止搜尋過程。</p><h3 id="範例一"><a href="#範例一" class="headerlink" title="範例一"></a>範例一</h3><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="kd-tree-nearest-neighbour-search-example-1.png" alt="KD 樹搜尋最近點範例一"></p><p>如圖所示，點 Q(2.1, 3.1) 為要查詢的點。</p><ol><li>從根節點開始走訪，根據分割維度的數據判斷應該進入左或右子樹<ol><li>進入 (7, 2)，分割軸為 x，(2.1 &lt; 7)，進入左子樹</li><li>進入 (5, 4)，分割軸為 y，(3.1 &lt; 4)，進入左子樹</li><li>進入 (2, 3)，分割軸為 x，(2.1 &gt; 2)，進入右子樹</li><li>右子樹為空，因此停止走訪，搜尋路徑依序為 (7, 2) -&gt; (5, 4) -&gt; (2, 3)</li></ol></li><li>根據搜尋路徑尋找最近鄰點：<ol><li>取出 (2, 3)，分割軸為 x<ol><li>計算到 Q 的距離得出 0.14，更新 P = 0.14</li><li>計算 Q 到 x = 2 的距離，|2.1 - 2| = 0.1</li><li>因為 0.1 &lt; 0.14，與超球面相交，進入 (2, 3) 的另一子樹<ol><li>另一子樹為空，因此停止走訪，搜尋路徑依序為 (7, 2) -&gt; (5, 4)</li></ol></li></ol></li><li>取出 (5, 4)，分割軸為 y<ol><li>計算到 Q 的距離得出 3.03，3.03 &gt; P，不用更新 P</li><li>計算 Q 到 y = 4 的距離，|3.1 - 4| = 0.9</li><li>因為 0.9 &gt; 0.14，沒有與超球面相交，剪掉 (5, 4) 的另一子樹</li></ol></li><li>取出 (7, 2)，分割軸為 x<ol><li>計算到 Q 的距離得出 5.02，5.02 &gt; P，不用更新 P</li><li>計算 Q 到 x = 7 的距離，|2.1 - 7| = 4.9</li><li>因為 4.9 &gt; 0.14，沒有與超球面相交，剪掉 (7, 2) 的另一子樹</li></ol></li></ol></li><li>至此搜尋路徑中的節點已經全部回溯完畢，返回：<ul><li>最近鄰點 P(2, 3)</li><li>最近距離為 0.1414</li></ul></li></ol><h3 id="範例二"><a href="#範例二" class="headerlink" title="範例二"></a>範例二</h3><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="kd-tree-nearest-neighbour-search-example-2.png" alt="KD 樹搜尋最近點範例二"></p><p>如下圖所示，點 Q(2, 4.5) 為要查詢的點。</p><ol><li>從根節點開始走訪，根據分割維度的數據判斷應該進入左或右子樹<ol><li>進入 (7, 2)，分割軸為 x，(2 &lt; 7)，進入左子樹</li><li>進入 (5, 4)，分割軸為 y，(4.5 &gt; 4)，進入右子樹</li><li>進入 (4, 7)，分割軸為 x，(2 &lt; 4)，進入左子樹</li><li>左子樹為空，因此停止走訪，搜尋路徑依序為 (7, 2) -&gt; (5, 4) -&gt; (4, 7)</li></ol></li><li>根據搜尋路徑尋找最近鄰點：<ol><li>取出 (4, 7)，分割軸為 x<ol><li>計算到 Q 的距離得出 3.20，更新 P = 3.20</li><li>計算 Q 到 x = 4 的距離，|2 - 4| = 2</li><li>因為 2 &lt; 3.20，與超球面相交，進入 (4, 7) 的另一子樹</li><li>另一子樹為空，因此停止走訪</li></ol></li><li>取出 (5, 4)，分割軸為 y<ol><li>計算到 Q 的距離得出 3.04，3.04 &lt; P，P = 3.04</li><li>計算 Q 到 y = 4 的距離，|4.5 - 4| = 0.5</li><li>因為 0.5 &lt; 3.04，與超球面相交，進入 (5, 4) 的另一子樹<ol><li>進入 (2, 3)，分割軸為 x，(2 &lt;= 2)，進入左子樹</li><li>左子樹為空，因此停止走訪，搜尋路徑依序為 (7, 2) -&gt; (2, 3)</li></ol></li></ol></li><li>取出 (2, 3)，分割軸為 x<ol><li>計算到 Q 的距離得出 1.5，1.5 &lt; P，P = 1.5</li><li>計算 Q 到 x = 2 的距離，|2 - 2| = 0</li><li>因為 0 &lt; 1.5，與超球面相交，進入 (2, 3) 的另一子樹<ol><li>另一子樹為空，因此停止走訪，搜尋路徑依序為 (7, 2)</li></ol></li></ol></li><li>取出 (7, 2)，分割軸為 x<ol><li>計算到 Q 的距離得出 5.59，5.59 &gt; P，不用更新 P</li><li>計算 Q 到 x = 7 的距離，|2 - 7| = 5</li><li>因為 5 &gt; 1.5，沒有與超球面相交，剪掉 (7, 2) 的另一子樹</li></ol></li></ol></li><li>至此搜尋路徑中的節點已經全部回溯完畢，返回：<ul><li>最近鄰點 P(2, 3)</li><li>最近距離為 1.5</li></ul></li></ol><h2 id="添加節點"><a href="#添加節點" class="headerlink" title="添加節點"></a>添加節點</h2><p>和 BST 樹添加節點的方式一樣。首先，從根節點開始判斷從哪個維度開始分割的，再依據該維度的元素確定要進入左節點還是右節點，直到找到葉節點，將待添加的節點依據該分割維度元素的大小進入左節點或右節點中。</p><p>按照這種方式添加節點可能會導致樹失去平衡，從而降低樹的性能。樹性能降低的比例取決於樹之前的空間分布，以及添加的節點樹和樹原大小的關係。如果樹變得很不平衡，就需要做樹的平衡，從而恢復依賴於樹平衡的查詢性能，例如最近臨查詢。</p><h2 id="刪除節點"><a href="#刪除節點" class="headerlink" title="刪除節點"></a>刪除節點</h2><p>從已經建立好的樹之中刪除節點，且不破壞限制條件，最簡單的方法是將待刪除的節點及其子樹做成集合，並重新建立子樹。</p><p>另外一個方法是為待刪除節點找一個替代點。首先，找到包含待刪除點的節點R，如果 R 是葉節點，則不需要替換，直接刪除R。如果是其他情況，從以 R 為根的子樹中找到一個替代點，設為 p，交換 R 和 p，再刪除 p。</p><p>找到一個可替換點的方法：假設節點 R 通過 x 軸來區分，並且 R 有一個右節點，找到這個右節點及其子樹中 x 值最小的點， 即可做為替換點。反之，找到左節點及其子樹中 x 值最大的點，即可做為替換點。</p><h2 id="平衡樹"><a href="#平衡樹" class="headerlink" title="平衡樹"></a>平衡樹</h2><p>KD 樹的平衡需要非常小心，因為 KD 樹通過多個維度來排序，所以樹旋轉這樣的技術不能用來做平衡，原因是這個技術可能破壞 KD 樹的限制條件。</p><p>KD 樹有幾種變體，包括：divided k-d tree, pseudo k-d tree, K-D-B-tree。這些變體裡面有許多是自適應 KD 樹。</p><h2 id="範圍搜索"><a href="#範圍搜索" class="headerlink" title="範圍搜索"></a>範圍搜索</h2><p>範圍搜索指的是使用範圍參數來做檢索，例如，如果一個 KD 樹儲存的是收入和年齡的樹值，那麼一個範圍搜索可能是：查找樹中年齡在 20 到 50，收入在 50000 到 80000 的節點。 應為 KD 樹在樹的每一層對域的範圍做了分割，所以可以高效執行範圍查詢。</p><h2 id="高維數據會降低性能"><a href="#高維數據會降低性能" class="headerlink" title="高維數據會降低性能"></a>高維數據會降低性能</h2><p>在隨機分布的數據點上，搜尋最近點時間複雜度是 O(log(N))，在高維度空間，維數災難會導致算法需要訪問遠多於低維空間的分支。在實踐中，如果節點的數量僅略高於維度的數量時，該算法僅比對所有點搜索的線性搜索略好。</p><p>在高維空間，KD樹是不適合做高效的近鄰搜尋。通常原則是，如果維度是 K，樹據點樹是 N，需要滿足 N &gt;&gt; 2^k。否則，當 KD 樹用在高維度數據上，搜尋時絕大多數節點需要做評估，所以性能不一定比窮舉搜索好，應該替換為一個近似的近鄰搜尋。</p><h2 id="參考文獻"><a href="#參考文獻" class="headerlink" title="參考文獻"></a>參考文獻</h2><ul><li><a href="http://www.cs.umd.edu/~mount/ANN/Files/1.1.2/ANNmanual_1.1.pdf">ANN (Approximate Nearest Neighbor) Programming Manual</a></li><li><a href="https://www.cs.umd.edu/users/mount/Papers/cgc99-smpack.pdf">It’s okay to be skinny, if your friends are fat</a></li><li><a href="https://en.wikipedia.org/wiki/K-d_tree">k-d tree</a></li><li><a href="https://kaba.hilvi.org/pastel-1.5.0/pastel/geometry/pointkdtree/pointkdtree.htm">Point kd-tree</a></li><li><a href="https://jiehust.github.io/data%20structure/2015/02/08/Kd-tree/">Kd Tree</a></li><li><a href="https://iter01.com/507556.html">Kd Tree 演算法詳解</a></li><li><a href="https://www.biaodianfu.com/knn.html">K - 近鄰算法 KNN 學習筆記</a></li><li><a href="https://vimsky.com/zh-tw/article/613.html">KD 樹 / K-D 樹</a></li><li><a href="https://www.itread01.com/content/1543394586.html">KD-TREE 演算法原理</a></li><li><a href="https://zhuanlan.zhihu.com/p/45346117">KD Tree 的原理及 Python 實現</a></li><li><a href="https://zhuanlan.zhihu.com/p/112246942">KD-Tree 原理詳解</a></li><li><a href="https://www.joinquant.com/view/community/detail/c2c41c79657cebf8cd871b44ce4f5d97">【量化課堂】kd 樹算法之詳細篇</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 演算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> kd tree </tag>
            
            <tag> 資料結構 </tag>
            
            <tag> 空間搜索 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>開源中文字體收藏</title>
      <link href="/post/open-source-chinese-font-list/"/>
      <url>/post/open-source-chinese-font-list/</url>
      
        <content type="html"><![CDATA[<p>整理一些能夠免費使用的開源字體，並標註授權方式，有些字體能夠免費使用但禁止商用，請自行注意。</p><h2 id="字型資料整理"><a href="#字型資料整理" class="headerlink" title="字型資料整理"></a>字型資料整理</h2><h3 id="justfont"><a href="#justfont" class="headerlink" title="justfont"></a>justfont</h3><ul><li>jf open 粉圓<ul><li>授權：SIL OPEN FONT LICENSE (OFL-1.1)</li><li>來源：justfont</li><li>Github：<a href="https://github.com/justfont/open-huninn-font">https://github.com/justfont/open-huninn-font</a></li><li>網站：<a href="https://blog.justfont.com/2020/02/huninn-preview/#more-9485">https://blog.justfont.com/2020/02/huninn-preview/#more-9485</a></li></ul></li></ul><h3 id="ButTaiwan"><a href="#ButTaiwan" class="headerlink" title="ButTaiwan"></a>ButTaiwan</h3><ul><li>源石黑體<ul><li>授權：SIL Open Font License 1.1</li><li>來源：ButTaiwan</li><li>Github：<a href="https://github.com/ButTaiwan/genseki-font">https://github.com/ButTaiwan/genseki-font</a></li></ul></li><li>源樣黑體<ul><li>授權：SIL Open Font License 1.1</li><li>來源：ButTaiwan</li><li>Github：<a href="https://github.com/ButTaiwan/genyog-font">https://github.com/ButTaiwan/genyog-font</a></li></ul></li><li>源樣明體<ul><li>授權：SIL Open Font License 1.1</li><li>來源：ButTaiwan</li><li>Github：<a href="https://github.com/ButTaiwan/genyo-font">https://github.com/ButTaiwan/genyo-font</a></li></ul></li><li>源流明體<ul><li>授權：SIL Open Font License 1.1</li><li>來源：ButTaiwan</li><li>Github：<a href="https://github.com/ButTaiwan/genryu-font">https://github.com/ButTaiwan/genryu-font</a></li></ul></li><li>源雲明體<ul><li>授權：SIL Open Font License 1.1</li><li>來源：ButTaiwan</li><li>Github：<a href="https://github.com/ButTaiwan/genwan-font">https://github.com/ButTaiwan/genwan-font</a></li></ul></li><li>源泉圓體<ul><li>授權：SIL Open Font License 1.1</li><li>來源：ButTaiwan</li><li>Github：<a href="https://github.com/ButTaiwan/gensen-font">https://github.com/ButTaiwan/gensen-font</a></li></ul></li></ul><h3 id="自家製フォント工房"><a href="#自家製フォント工房" class="headerlink" title="自家製フォント工房"></a>自家製フォント工房</h3><ul><li>源柔黑體<ul><li>授權：SIL Open Font License 1.1</li><li>來源：自家製フォント工房</li><li>網站：<a href="http://jikasei.me/font/genjyuu/">http://jikasei.me/font/genjyuu/</a></li></ul></li></ul><h3 id="瀨戶字體"><a href="#瀨戶字體" class="headerlink" title="瀨戶字體"></a>瀨戶字體</h3><ul><li><p>瀨戶字體</p><ul><li>備註：原版</li><li>授權：Open Font License 1.1</li><li>來源：瀨戶</li><li>網站：<a href="https://zh-tw.osdn.net/projects/setofont/">https://zh-tw.osdn.net/projects/setofont/</a></li></ul></li><li><p>內海字體</p><ul><li>備註：基於 <code>瀨戶字體</code> 的修正版</li><li>授權：OFL-1.1 License</li><li>來源：內海字體</li><li>Github：<a href="https://github.com/max32002/naikaifont">https://github.com/max32002/naikaifont</a></li></ul></li><li><p>cjkFonts 全瀨體</p><ul><li>備註：使用 <code>瀨戶字體</code> 透過深度學習的修正版</li><li>授權：SIL Open Font License</li><li>來源：cjkFonts</li><li>網站：<a href="https://www.cjkfonts.io/blog/cjkfonts_allseto">https://www.cjkfonts.io/blog/cjkfonts_allseto</a></li></ul></li><li><p>小賴字體</p><ul><li>備註：基於 <code>瀨戶字體</code>、<code>內海字體</code>、<code>cjkFonts 全瀨體</code> 的修正版</li><li>授權：SIL Open Font License 1.1</li><li>來源：小賴字體</li><li>Github：<a href="https://github.com/lxgw/kose-font/">https://github.com/lxgw/kose-font/</a></li></ul></li></ul><h3 id="花園明朝體"><a href="#花園明朝體" class="headerlink" title="花園明朝體"></a>花園明朝體</h3><ul><li>花園明朝體<ul><li>授權：SIL Open Font License (OFL)</li><li>來源：花園明朝體 (HanaMin)</li><li>網站：<a href="http://fonts.jp/hanazono/">http://fonts.jp/hanazono/</a></li></ul></li></ul><h3 id="IPAmj明朝"><a href="#IPAmj明朝" class="headerlink" title="IPAmj明朝"></a>IPAmj明朝</h3><ul><li>IPAmj明朝<ul><li>授權：IPA Font License Agreement v1.0</li><li>來源：IPAmj明朝 (IPAmjMincho)</li><li>網站：<a href="https://mojikiban.ipa.go.jp/1300.html">https://mojikiban.ipa.go.jp/1300.html</a></li></ul></li></ul><h3 id="cwtex-q-fonts"><a href="#cwtex-q-fonts" class="headerlink" title="cwtex-q-fonts"></a>cwtex-q-fonts</h3><ul><li>cwTeX 字型<ul><li>授權：SIL Open Font License (Version 1.1)</li><li>來源：cwtex-q-fonts</li><li>Github：<a href="https://github.com/l10n-tw/cwtex-q-fonts">https://github.com/l10n-tw/cwtex-q-fonts</a></li></ul></li></ul><h3 id="文泉驛"><a href="#文泉驛" class="headerlink" title="文泉驛"></a>文泉驛</h3><ul><li>文泉驛正黑體<ul><li>授權：GNU General Public License version 3.0 (GPLv3)</li><li>來源：文泉驛</li><li>網站：<a href="http://wenq.org/">http://wenq.org/</a></li></ul></li><li>文泉驛微米黑<ul><li>授權：GNU General Public License version 3.0 (GPLv3)</li><li>來源：文泉驛</li><li>網站：<a href="http://wenq.org/">http://wenq.org/</a></li></ul></li></ul><h3 id="清松手寫體"><a href="#清松手寫體" class="headerlink" title="清松手寫體"></a>清松手寫體</h3><ul><li>清松手寫體<ul><li>授權：SIL Open Font License</li><li>來源：游清松 - 清松手寫體</li><li>Facebook 社團：<a href="https://www.facebook.com/groups/549661292148791/">https://www.facebook.com/groups/549661292148791/</a></li><li>Github：<a href="https://github.com/jasonhandwriting/JasonHandwriting">https://github.com/jasonhandwriting/JasonHandwriting</a></li></ul></li></ul><h3 id="翰字鑄造"><a href="#翰字鑄造" class="headerlink" title="翰字鑄造"></a>翰字鑄造</h3><ul><li>台北黑體<ul><li>授權：SIL Open Font License 1.1</li><li>來源：翰字鑄造</li><li>GoogleDrive：<a href="https://drive.google.com/drive/u/0/folders/1OJOOly6jo9RID3EE2f7S3N7T-8ZWPv6N">https://drive.google.com/drive/u/0/folders/1OJOOly6jo9RID3EE2f7S3N7T-8ZWPv6N</a></li><li>網站：<a href="https://sites.google.com/view/jtfoundry/zh-tw/downloads">https://sites.google.com/view/jtfoundry/zh-tw/downloads</a></li></ul></li></ul><h3 id="全字庫"><a href="#全字庫" class="headerlink" title="全字庫"></a>全字庫</h3><ul><li><p>全字庫正楷體</p><ul><li>授權：<a href="https://data.gov.tw/license">政府資料開放授權條款</a></li><li>來源：國家發展委員會</li><li>網站：<a href="https://data.gov.tw/dataset/5961?fbclid=IwAR2xVeUaoV3p0d4fJskkm92Ggfc9q8KimzmHPqMqGcqVJA-srDF0LAdZ8j8">https://data.gov.tw/dataset/5961?fbclid=IwAR2xVeUaoV3p0d4fJskkm92Ggfc9q8KimzmHPqMqGcqVJA-srDF0LAdZ8j8</a></li></ul></li><li><p>全字庫正宋體</p><ul><li>授權：<a href="https://data.gov.tw/license">政府資料開放授權條款</a></li><li>來源：國家發展委員會</li><li>網站：<a href="https://data.gov.tw/dataset/5961?fbclid=IwAR2xVeUaoV3p0d4fJskkm92Ggfc9q8KimzmHPqMqGcqVJA-srDF0LAdZ8j8">https://data.gov.tw/dataset/5961?fbclid=IwAR2xVeUaoV3p0d4fJskkm92Ggfc9q8KimzmHPqMqGcqVJA-srDF0LAdZ8j8</a></li></ul></li></ul><h3 id="Adobe"><a href="#Adobe" class="headerlink" title="Adobe"></a>Adobe</h3><ul><li><p>思源黑體 ( Source Han Sans )</p><ul><li>授權：SIL OPEN FONT LICENSE Version 1.1</li><li>來源：Adobe</li><li>Github：<a href="https://github.com/adobe-fonts/source-han-sans">https://github.com/adobe-fonts/source-han-sans</a></li><li>網站：<a href="https://fonts.google.com/specimen/Noto+Sans+TC?subset=chinese-traditional">https://fonts.google.com/specimen/Noto+Sans+TC?subset=chinese-traditional</a></li></ul></li><li><p>思源宋體 ( Source Han Serif )</p><ul><li>授權：SIL OPEN FONT LICENSE Version 1.1</li><li>來源：Adobe</li><li>Github：<a href="https://github.com/adobe-fonts/source-han-serif/tree/release">https://github.com/adobe-fonts/source-han-serif/tree/release</a></li><li>網站：<a href="https://fonts.google.com/specimen/Noto+Serif+TC?subset=chinese-traditional">https://fonts.google.com/specimen/Noto+Serif+TC?subset=chinese-traditional</a></li></ul></li><li><p>思源等寬 ( Source Han Mono )</p><ul><li>授權：SIL OPEN FONT LICENSE Version 1.1</li><li>來源：Adobe</li><li>Github：<a href="https://github.com/adobe-fonts/source-han-mono">https://github.com/adobe-fonts/source-han-mono</a></li></ul></li></ul><h3 id="刻石錄"><a href="#刻石錄" class="headerlink" title="刻石錄"></a>刻石錄</h3><ul><li><p>I.明體</p><ul><li>授權：IPA 開放字型授權條款 第 1.0 版</li><li>來源：刻石錄</li><li>網站：<a href="https://github.com/ichitenfont/I.Ming">https://github.com/ichitenfont/I.Ming</a></li><li>網站：<a href="http://founder.acgvlyric.org/iu/doku.php/%E9%80%A0%E5%AD%97:%E9%96%8B%E6%BA%90%E5%AD%97%E5%9E%8B_i.%E6%98%8E%E9%AB%94">http://founder.acgvlyric.org/iu/doku.php/%E9%80%A0%E5%AD%97:%E9%96%8B%E6%BA%90%E5%AD%97%E5%9E%8B_i.%E6%98%8E%E9%AB%94</a></li></ul></li><li><p>I.顏體</p><ul><li>授權：GNU GPL 2.0 或以上</li><li>來源：刻石錄</li><li>網站：<a href="http://founder.acgvlyric.org/iu/doku.php/%E9%80%A0%E5%AD%97:%E9%96%8B%E6%BA%90%E5%AD%97%E5%9E%8B_i.%E9%A1%8F%E9%AB%94">http://founder.acgvlyric.org/iu/doku.php/%E9%80%A0%E5%AD%97:%E9%96%8B%E6%BA%90%E5%AD%97%E5%9E%8B_i.%E9%A1%8F%E9%AB%94</a></li></ul></li><li><p>I.鋼筆鶴體</p><ul><li>授權：GNU GPL 2.0 或以上</li><li>來源：刻石錄</li><li>網站：<a href="http://founder.acgvlyric.org/iu/doku.php/%E9%80%A0%E5%AD%97:%E9%96%8B%E6%BA%90%E5%AD%97%E5%9E%8B_i.%E9%8B%BC%E7%AD%86%E9%B6%B4%E9%AB%94">http://founder.acgvlyric.org/iu/doku.php/%E9%80%A0%E5%AD%97:%E9%96%8B%E6%BA%90%E5%AD%97%E5%9E%8B_i.%E9%8B%BC%E7%AD%86%E9%B6%B4%E9%AB%94</a></li></ul></li></ul><h3 id="教育部"><a href="#教育部" class="headerlink" title="教育部"></a>教育部</h3><ul><li><p>教育部標準楷書</p><ul><li>授權：創用 CC「姓名標示   - 禁止改作」3.0 臺灣版授權</li><li>來源：中華民國教育部</li><li>網站：<a href="https://language.moe.gov.tw/result.aspx?classify_sn=23&amp;subclassify_sn=436&amp;content_sn=47">https://language.moe.gov.tw/result.aspx?classify_sn=23&amp;subclassify_sn=436&amp;content_sn=47</a></li></ul></li><li><p>教育部標準宋體</p><ul><li>授權：創用 CC「姓名標示   - 禁止改作」3.0 臺灣版授權</li><li>來源：中華民國教育部</li><li>網站：<a href="https://language.moe.gov.tw/result.aspx?classify_sn=23&amp;subclassify_sn=436&amp;content_sn=48">https://language.moe.gov.tw/result.aspx?classify_sn=23&amp;subclassify_sn=436&amp;content_sn=48</a></li></ul></li><li><p>教育部隸書</p><ul><li>授權：創用 CC「姓名標示   - 禁止改作」3.0 臺灣版授權</li><li>來源：中華民國教育部</li><li>網站：<a href="https://language.moe.gov.tw/result.aspx?classify_sn=23&amp;subclassify_sn=436&amp;content_sn=49">https://language.moe.gov.tw/result.aspx?classify_sn=23&amp;subclassify_sn=436&amp;content_sn=49</a></li></ul></li></ul><h3 id="王漢宗"><a href="#王漢宗" class="headerlink" title="王漢宗"></a>王漢宗</h3><ul><li>王漢宗 42 套自由字型<ul><li>備註1：網站訊息顯示有 48 套，但實際下載是 42 套。</li><li>備註2：在下方字型列表中列出較具爭議的的 10 個王漢宗自由字型，請斟酌使用</li><li>授權：GNU GPL v2</li><li>網站：<a href="https://123.briian.com/forum.php?mod=viewthread&amp;tid=2152">https://123.briian.com/forum.php?mod=viewthread&amp;tid=2152</a></li><li>爭議字型 ( <a href="https://zh.wikipedia.org/wiki/%E7%8E%8B%E6%BC%A2%E5%AE%97%E8%87%AA%E7%94%B1%E5%AD%97%E5%9E%8B">詳細內容</a> )：<ul><li>王漢宗中仿宋</li><li>王漢宗中仿宋簡體</li><li>王漢宗隸書體</li><li>王漢宗中明體</li><li>王漢宗粗明體</li><li>王漢宗特明體</li><li>王漢宗細圓體</li><li>王漢宗特圓體</li><li>王漢宗疊圓體</li><li>王漢宗勘亭流</li><li>王漢宗綜藝體</li><li>王漢宗中行書</li><li>王漢宗綜藝體雙空陰</li><li>王漢宗粗楷體簡體</li></ul></li></ul></li></ul><h3 id="文鼎"><a href="#文鼎" class="headerlink" title="文鼎"></a>文鼎</h3><ul><li><p>文鼎PL細上海宋</p><ul><li>授權：文鼎公眾授權書（1999 年版本）</li><li>來源：文鼎科技</li><li>網站：<a href="https://123.briian.com/forum.php?mod=viewthread&amp;tid=5429">https://123.briian.com/forum.php?mod=viewthread&amp;tid=5429</a></li></ul></li><li><p>文鼎PL中楷</p><ul><li>授權：文鼎公眾授權書（1999 年版本）</li><li>來源：文鼎科技</li><li>網站：<a href="https://123.briian.com/forum.php?mod=viewthread&amp;tid=5429">https://123.briian.com/forum.php?mod=viewthread&amp;tid=5429</a></li></ul></li><li><p>文鼎PL明體U20-L</p><ul><li>授權：公眾授權字型、禁止商業使用、不屬於自由軟體許可</li><li>來源：文鼎科技</li><li>網站：<a href="http://www.arphic.com.tw/2019/03/27/%E6%96%87%E9%BC%8E%E5%85%AC%E7%9C%BE%E6%8E%88%E6%AC%8A%E5%AD%97%E5%9E%8B/">http://www.arphic.com.tw/2019/03/27/%E6%96%87%E9%BC%8E%E5%85%AC%E7%9C%BE%E6%8E%88%E6%AC%8A%E5%AD%97%E5%9E%8B/</a></li></ul></li><li><p>文鼎PL報宋2GBK</p><ul><li>授權：公眾授權字型、禁止商業使用、不屬於自由軟體許可</li><li>來源：文鼎科技</li><li>網站：<a href="http://www.arphic.com.tw/2019/03/27/%E6%96%87%E9%BC%8E%E5%85%AC%E7%9C%BE%E6%8E%88%E6%AC%8A%E5%AD%97%E5%9E%8B/">http://www.arphic.com.tw/2019/03/27/%E6%96%87%E9%BC%8E%E5%85%AC%E7%9C%BE%E6%8E%88%E6%AC%8A%E5%AD%97%E5%9E%8B/</a></li></ul></li></ul><h2 id="名詞解釋"><a href="#名詞解釋" class="headerlink" title="名詞解釋"></a>名詞解釋</h2><h3 id="ttc檔-TrueType-Collection"><a href="#ttc檔-TrueType-Collection" class="headerlink" title="ttc檔 ( TrueType Collection )"></a>ttc檔 ( TrueType Collection )</h3><p>字型集合檔案，多個字型 <code>.ttc</code> 組合成一個字體集合文件，單一文件能夠包含多種字體</p><h3 id="ttf檔-TrueType-Font"><a href="#ttf檔-TrueType-Font" class="headerlink" title="ttf檔 ( TrueType Font )"></a>ttf檔 ( TrueType Font )</h3><p>單一字型檔，存放一種字型</p><h3 id="otf檔-OpenType-Font"><a href="#otf檔-OpenType-Font" class="headerlink" title="otf檔 ( OpenType Font )"></a>otf檔 ( OpenType Font )</h3><p>以 Unicode 為開發基礎，儲存的字型比 <code>TrueType</code> 還要多，螢幕表現也更平滑漂亮，並且可以安裝在 Windows 與 Mac 上</p><h2 id="相關文獻"><a href="#相關文獻" class="headerlink" title="相關文獻"></a>相關文獻</h2><ol><li><a href="https://blog.justfont.com/2018/08/ytb-license/">被吉發函的創作者，字型廠商恐成最大贏家？創作者避免字體侵權的攻略</a></li><li><a href="https://www.facebook.com/notes/%E5%AD%97%E5%97%A8/%E7%B0%A1%E5%96%AE%E6%8F%8F%E8%BF%B0%E4%B8%80%E4%B8%8Byoutuber%E5%90%88%E6%B3%95%E4%BD%BF%E7%94%A8%E4%B8%AD%E6%96%87%E5%AD%97%E5%9E%8B%E7%9A%84%E7%AE%A1%E9%81%93/1112404835581057/">簡單描述一下YouTuber合法使用中文字型的管道</a></li><li><a href="https://blog.justfont.com/2020/03/source-han-tree/#more-9676">思源改作，免費中文字體下載指南</a></li><li><a href="https://ahui3c.com/64375/free-cht-fonet#%E5%9C%93%E9%AB%94%E5%AD%97%E5%9E%8B">[筆記] 2020 合法免費中文字型收集 / 開源 / 可商用 / 免費字體</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 開源字體 </tag>
            
            <tag> 免費字體 </tag>
            
            <tag> 中文字體 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo 網站架設</title>
      <link href="/post/hexo-website-setup/"/>
      <url>/post/hexo-website-setup/</url>
      
        <content type="html"><![CDATA[<p>使用 <a href="https://hexo.io/zh-tw/">Hexo</a> 產生靜態網站，並部署在 GitHub Pages 上，可用於產生個人網站或形象網站。</p><h2 id="安裝環境"><a href="#安裝環境" class="headerlink" title="安裝環境"></a>安裝環境</h2><ul><li>Node.js<ul><li><a href="https://nodejs.org/">https://nodejs.org/</a></li></ul></li><li>Git<ul><li><a href="https://git-scm.com/">https://git-scm.com/</a></li></ul></li></ul><p>開啟 <code>Cmd</code> 或 <code>Git Bash</code>，輸入指令安裝 <a href="https://github.com/hexojs/hexo">Hexo</a>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure><h2 id="建立環境"><a href="#建立環境" class="headerlink" title="建立環境"></a>建立環境</h2><p>安裝完 Hexo 後，建立一個資料夾，並進入該資料夾進行 Hexo 初始化，網站的內容都將儲存在此處。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br></pre></td></tr></table></figure><p>安裝相依套件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure><h2 id="執行環境"><a href="#執行環境" class="headerlink" title="執行環境"></a>執行環境</h2><p>到此 Hexo 就已經安裝好了，網站資料夾內會產生 <a href="#%E6%AA%94%E6%A1%88%E6%9E%B6%E6%A7%8B">Hexo 架構檔案</a>，可以啟動 server 查看網站。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></table></figure><p>開啟瀏覽器進入預設路徑 <a href="http://localhost:4000/">http://localhost:4000/</a>。</p><blockquote><p>停止 server 只需在 CLI 執行中斷命令 <code>Ctrl</code> + <code>C</code></p></blockquote><p>如果想要變更連接埠 (port)，可以在執行時使用 <code>-p</code> 選項指定其他連接埠。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server -p 5000</span><br></pre></td></tr></table></figure><h2 id="產生網站內容"><a href="#產生網站內容" class="headerlink" title="產生網站內容"></a>產生網站內容</h2><p>在本地電腦啟動環境，主要是確認產生的網站內容是否正確、網頁是否打的開，接著就是要讓 Hexo 經過主題渲染，產生我們的網站檔案。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo generate</span><br></pre></td></tr></table></figure><p>生成的檔案會放在根目錄的 <code>Public</code> 資料夾下，裡面存放有網站最重要的入口檔案 <code>index.html</code> 等檔案，部署網站時就是發佈這個 <code>Public</code> 資料夾。</p><h2 id="清除快取與靜態檔案"><a href="#清除快取與靜態檔案" class="headerlink" title="清除快取與靜態檔案"></a>清除快取與靜態檔案</h2><p>對於已經產生過的網站內容，如果要重新產生，可以使用 <code>clean</code> 清除快取檔案 (db.json) 與 靜態檔案 (Public)。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br></pre></td></tr></table></figure><h2 id="部署網站到-GitHub-Pages"><a href="#部署網站到-GitHub-Pages" class="headerlink" title="部署網站到 GitHub Pages"></a>部署網站到 GitHub Pages</h2><p>先在 GitHub 上創建一個資料庫名稱為 <code>&lt;username&gt;.github.io</code></p><blockquote><p>&lt;username&gt; 代表你的 GitHub 用戶名</p></blockquote><p>回到 CLI 安裝 <a href="https://github.com/hexojs/hexo-deployer-git">hexo-deployer-git</a>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>編輯網站目錄下 <code>_config.yml</code> 文件，並在結尾處加入 deploy 填寫部署網站相關資料。</p><ul><li><p>/_config.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/&lt;username&gt;/&lt;username&gt;.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><p>yaml 檔案中 <code>:</code> 後面需要保持一個空格</p></blockquote><p>接著還要填寫 <code>config.yml</code> 內的 <code>url</code> 成剛剛建立的儲存庫 url。</p><ul><li><p>/_config.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">url:</span> <span class="string">https://&lt;username&gt;.github.io</span></span><br></pre></td></tr></table></figure></li></ul><p>部署網站到 GitHub 上。先使用 clean 清除快取檔案，再使用 generate 產生網站檔案，最後使用 deploy 部署網站。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo deploy --generate</span><br></pre></td></tr></table></figure><p>部署完成後就可以到網站上查看結果 <code>&lt;username&gt;.github.io</code>，通常 GitHub 會有緩存，可以等 5~15 分鐘左右再進入網站看。</p><blockquote><p>這時候已經部署完畢，但可能還是會出現 404 頁面，因為還沒有開啟儲存庫的 Github Pages 功能。</p><ul><li>進入儲存庫的 <code>Setting</code>，往下找到 Github Pages 區塊，並將 <code>Source</code> 指向到 master 再按下 Save 即可。</li></ul></blockquote><h2 id="清理瀏覽器快取"><a href="#清理瀏覽器快取" class="headerlink" title="清理瀏覽器快取"></a>清理瀏覽器快取</h2><p>如果在本地端更改設定測試時沒有問題，部署到網路上後卻沒有改變或顯示錯誤，大多數時候是因為電腦的瀏覽器的快取檔案原因。</p><p>解決辦法可嘗試清除瀏覽器的快取資料，再重新整理網站載入資料。</p><p><img src= "https://cdn.jsdelivr.net/gh/YuCheng21/cdn-yucheng@master/blog/loading.gif" data-lazy-src="Clean-browser-cache.png" alt="清理瀏覽器快取"></p><h2 id="新增文章"><a href="#新增文章" class="headerlink" title="新增文章"></a>新增文章</h2><p>建立一篇新的文章，如果沒有設定 <code>layout</code>，則會使用 <code>_config.yml</code> 中的 <code>default_layout</code> 設定代替。如果標題包含空格的話，需使用引號刮起來。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure><ul><li>[layout]：文章布局<ul><li>post</li><li>draft</li></ul></li><li>&lt;title&gt;：文章標題</li></ul><h2 id="新增草稿"><a href="#新增草稿" class="headerlink" title="新增草稿"></a>新增草稿</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>建立一篇新的草稿，草稿在 Hexo 執行時不會進行渲染。需透過 <code>publish</code> 發布草稿，將草稿移動到 <code>source/_posts</code> 資料夾。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new draft &lt;title&gt;</span><br></pre></td></tr></table></figure><p>發布草稿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo publish draft &lt;title&gt;</span><br></pre></td></tr></table></figure><blockquote><p>草稿預設不會顯示於頁面中，可在執行時加上 <code>--draft</code> 選項，或是把 <code>render_drafts</code> 設定改為 <code>true</code> 來預覽草稿。</p></blockquote><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>如果覺得每次還要輸入發布草稿很麻煩，也可以在 <code>_post</code> 資料夾內新增一個資料夾以底線開頭，因為 Hexo 不會編譯 <code>_post</code> 內有 <code>_</code> 開頭的資料夾，所以可以建立一個資料夾例如 <code>_draft</code>，然後將還不想要發布的文章丟到 <code>/source/_post/_draft/</code> 裡面即可。</p><h2 id="檔案架構"><a href="#檔案架構" class="headerlink" title="檔案架構"></a>檔案架構</h2><p>產生完 Hexo 檔案後大致有以下檔案</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── _config.yml</span><br><span class="line">├── package.json</span><br><span class="line">├── scaffolds</span><br><span class="line">├── <span class="built_in">source</span></span><br><span class="line">|   ├── _drafts</span><br><span class="line">|   └── _posts</span><br><span class="line">└── themes</span><br></pre></td></tr></table></figure><ul><li>_config.yml<br>網站配置檔案，設置網站基本設定。</li><li>package.json<br>應用程式資料，包含使用的一些相依套件。</li><li>scaffolds<br>新增文章時使用的架構資料夾，Hexo 會根據 scaffolds 來建立檔案。</li><li>source<br>來源資料夾，存放網站的內容，Markdown 和 HTML 檔案在產生時會經過渲染到 <code>Public</code> 資料夾，而其他的檔案會直接拷貝過去。</li><li>themes<br>主題資料夾，Hexo 會根據主題來產生靜態檔案。</li></ul><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://hexo.io/zh-tw/docs/">文件 | Hexo</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.js </tag>
            
            <tag> Git </tag>
            
            <tag> GitHub Pages </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
